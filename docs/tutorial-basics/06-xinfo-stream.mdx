---
sidebar_position: 6
---

#  XINFO STREAM
The `XINFO STREAM` command in Redis is like the "stream metadata inspector" â€” it gives you detailed internal information about a stream key, similar to how you'd use .describe() in databases or introspection in code.


```bash
XINFO STREAM [key]
```

## What does XINFO STREAM return?
| Field               | Description                                            |
| ------------------- | ------------------------------------------------------ |
| `length`            | Total number of entries in the stream (same as `XLEN`) |
| `radix-tree-keys`   | Number of radix-tree nodes (internal Redis structure)  |
| `radix-tree-nodes`  | Number of radix-tree leaves                            |
| `groups`            | Number of consumer groups attached to the stream       |
| `last-generated-id` | The last automatically generated stream ID             |
| `first-entry`       | The very first entry in the stream                     |
| `last-entry`        | The latest entry in the stream                         |

## Example
```
127.0.0.1:6379> xinfo stream race:france
 1) "length"
 2) (integer) 50
 3) "radix-tree-keys"
 4) (integer) 1
 5) "radix-tree-nodes"
 6) (integer) 2
 7) "last-generated-id"
 8) "1754326272465-49"
 9) "max-deleted-entry-id"
10) "0-0"
11) "entries-added"
12) (integer) 50
13) "recorded-first-entry-id"
14) "1754326272465-0"
15) "groups"
16) (integer) 0
17) "first-entry"
18) 1) "1754326272465-0"
    2) 1) "rider"
       2) "Lopez"
       3) "speed"
       4) "31.5"
       5) "position"
       6) "1"
       7) "location_id"
       8) "1"
19) "last-entry"
20) 1) "1754326272465-49"
    2) 1) "rider"
       2) "Roglic"
       3) "speed"
       4) "20.3"
       5) "position"
       6) "50"
       7) "location_id"
       8) "3"
```

## Spring Boot Example (Using Spring Data Redis)
You can create a new Spring Boot project or reuse your existing project. Here's how to integrate XLEN into your app by adding a controller class.

```
spring init -d=web,data-redis,devtools,thymeleaf,lombok \
  -g com.example \
  -a demo \
  -p jar \
  --build maven \
  xinfostream -x
```

add the following to application.yaml
```
spring:
  data:
    redis:
      host: localhost
      port: 6379
```

If you're reusing an existing project (like xrange or race:france), simply add this private static controller class inside your DemoApplication:

```java
@RestController
@RequestMapping("/api/stream")
@RequiredArgsConstructor
class StreamInfoController {

  private final StringRedisTemplate redisTemplate;

  @GetMapping("/info")
  public StreamInfo.XInfoStream getStreamInfo(@RequestParam(defaultValue = "race:france") String streamKey) {
    return redisTemplate.execute((RedisCallback<StreamInfo.XInfoStream>) connection ->
      connection.streamCommands().xInfo(streamKey.getBytes())
    );
  }
}
```

## Example: curl to query
You may notice that the following result return correctly. However the details is encoded.
```
curl "http://localhost:8080/api/stream/info?streamKey=race:france" | jq   

{
  "raw": {
    "length": 50,
    "radix-tree-keys": 1,
    "radix-tree-nodes": 2,
    "last-generated-id": "1754326272465-49",
    "max-deleted-entry-id": "0-0",
    "entries-added": 50,
    "recorded-first-entry-id": "1754326272465-0",
    "groups": 0,
    "first-entry": {
      "1754326272465-0": {
        "[B@463e999b": "TG9wZXo=",
        "[B@6be77c45": "MzEuNQ==",
        "[B@cd92da8": "MQ==",
        "[B@2fdfd2dc": "MQ=="
      }
    },
    "last-entry": {
      "1754326272465-49": {
        "[B@1d9f74fd": "Um9nbGlj",
        "[B@4dca265f": "MjAuMw==",
        "[B@83bf623": "NTA=",
        "[B@59238cca": "Mw=="
      }
    }
  },
  "firstEntry": {
    "1754326272465-0": {
      "[B@463e999b": "TG9wZXo=",
      "[B@6be77c45": "MzEuNQ==",
      "[B@cd92da8": "MQ==",
      "[B@2fdfd2dc": "MQ=="
    }
  },
  "lastEntry": {
    "1754326272465-49": {
      "[B@1d9f74fd": "Um9nbGlj",
      "[B@4dca265f": "MjAuMw==",
      "[B@83bf623": "NTA=",
      "[B@59238cca": "Mw=="
    }
  }
}
```

## Return Your Custom DTO Instead
To resolve this, change your controller method to return StreamInfoDto (the decoded version). We'll create the custom class to corresponse the field and decoded it during the retrieve information.
```java

@SpringBootApplication
public class DemoApplication {

	public static void main(String[] args) {
		SpringApplication.run(DemoApplication.class, args);
	}

}

@Data
@Builder
class StreamEntryDto {
	private String id;
	private Map<String, String> fields;
}

@Data
@Builder
class StreamInfoDto {
	private long length;
	private long radixTreeKeys;
	private long radixTreeNodes;
	private long groupCount;
	private String lastGeneratedId;
	private StreamEntryDto firstEntry;
	private StreamEntryDto lastEntry;
}

@RestController
@RequestMapping("/api/stream")
@RequiredArgsConstructor
class StreamInfoController {

  private final StringRedisTemplate redisTemplate;

  @GetMapping("/info")
  public StreamInfoDto getStreamInfo(@RequestParam(defaultValue = "race:france") String streamKey) {
    StreamInfo.XInfoStream info = redisTemplate.execute((RedisCallback<StreamInfo.XInfoStream>) connection ->
        connection.streamCommands().xInfo(streamKey.getBytes(StandardCharsets.UTF_8))
    );

    if (info == null) return null;

    StreamEntryDto firstEntry = convertStreamEntry(info.getFirstEntry());
    StreamEntryDto lastEntry = convertStreamEntry(info.getLastEntry());

    return StreamInfoDto.builder()
        .length(info.streamLength())
        .radixTreeKeys(info.radixTreeKeySize())
        .radixTreeNodes(info.radixTreeNodesSize())
        .groupCount(info.groupCount())
        .lastGeneratedId(info.lastGeneratedId())
        .firstEntry(firstEntry)
        .lastEntry(lastEntry)
        .build();
  }

  private StreamEntryDto convertStreamEntry(Map<Object, Object> rawEntry) {
    if (rawEntry == null || rawEntry.isEmpty()) {
      return null;
    }

    Map.Entry<Object, Object> outer = rawEntry.entrySet().iterator().next();

    String id = outer.getKey().toString();
    Object inner = outer.getValue();

    if (!(inner instanceof Map<?, ?> innerMap)) {
      return null;
    }

    Map<String, String> fields = new LinkedHashMap<>();
    for (Map.Entry<?, ?> e : innerMap.entrySet()) {
      String fieldKey = decodeObject(e.getKey());
      String fieldValue = decodeObject(e.getValue());
      fields.put(fieldKey, fieldValue);
    }

    return StreamEntryDto.builder()
        .id(id)
        .fields(fields)
        .build();
  }

  private String decodeObject(Object obj) {
    if (obj instanceof byte[] bytes) {
      return new String(bytes, StandardCharsets.UTF_8);
    }
    return obj != null ? obj.toString() : "";
  }

}
```


## Example: curl to query
```
curl "http://localhost:8080/api/stream/info?streamKey=race:france" | jq  

{
  "length": 50,
  "radixTreeKeys": 1,
  "radixTreeNodes": 2,
  "groupCount": 0,
  "lastGeneratedId": "1754326272465-49",
  "firstEntry": {
    "id": "1754326272465-0",
    "fields": {
      "[B@33a47a52": "Lopez",
      "[B@4c2ff638": "31.5",
      "[B@79d1a02a": "1",
      "[B@4aecb999": "1"
    }
  },
  "lastEntry": {
    "id": "1754326272465-49",
    "fields": {
      "[B@5a8a3c7c": "Roglic",
      "[B@69278f23": "20.3",
      "[B@1d03b2dd": "50",
      "[B@328ce095": "3"
    }
  }
}
```